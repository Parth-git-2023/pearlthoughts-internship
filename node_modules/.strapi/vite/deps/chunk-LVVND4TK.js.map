{
  "version": 3,
  "sources": ["../../../../../packages/core/admin/admin/src/services/users.ts"],
  "sourcesContent": ["import * as Permissions from '../../../shared/contracts/permissions';\r\nimport * as Roles from '../../../shared/contracts/roles';\r\nimport * as Users from '../../../shared/contracts/user';\r\n\r\nimport { adminApi } from './api';\r\n\r\nimport type { Data } from '@strapi/types';\r\n\r\nconst usersService = adminApi\r\n  .enhanceEndpoints({\r\n    addTagTypes: ['LicenseLimits', 'User', 'Role', 'RolePermissions'],\r\n  })\r\n  .injectEndpoints({\r\n    endpoints: (builder) => ({\r\n      /**\r\n       * users\r\n       */\r\n      createUser: builder.mutation<Users.Create.Response['data'], Users.Create.Request['body']>({\r\n        query: (body) => ({\r\n          url: '/admin/users',\r\n          method: 'POST',\r\n          data: body,\r\n        }),\r\n        transformResponse: (response: Users.Create.Response) => response.data,\r\n        invalidatesTags: ['LicenseLimits', { type: 'User', id: 'LIST' }],\r\n      }),\r\n      updateUser: builder.mutation<\r\n        Users.Update.Response['data'],\r\n        Omit<Users.Update.Request['body'] & Users.Update.Params, 'blocked'>\r\n      >({\r\n        query: ({ id, ...body }) => ({\r\n          url: `/admin/users/${id}`,\r\n          method: 'PUT',\r\n          data: body,\r\n        }),\r\n        invalidatesTags: (_res, _err, { id }) => [\r\n          { type: 'User', id },\r\n          { type: 'User', id: 'LIST' },\r\n        ],\r\n      }),\r\n      getUsers: builder.query<\r\n        {\r\n          users: Users.FindAll.Response['data']['results'];\r\n          pagination: Users.FindAll.Response['data']['pagination'] | null;\r\n        },\r\n        GetUsersParams\r\n      >({\r\n        query: ({ id, ...params } = {}) => ({\r\n          url: `/admin/users/${id ?? ''}`,\r\n          method: 'GET',\r\n          config: {\r\n            params,\r\n          },\r\n        }),\r\n        transformResponse: (res: Users.FindAll.Response | Users.FindOne.Response) => {\r\n          let users: Users.FindAll.Response['data']['results'] = [];\r\n\r\n          if (res.data) {\r\n            if ('results' in res.data) {\r\n              if (Array.isArray(res.data.results)) {\r\n                users = res.data.results;\r\n              }\r\n            } else {\r\n              users = [res.data];\r\n            }\r\n          }\r\n\r\n          return {\r\n            users,\r\n            pagination: 'pagination' in res.data ? res.data.pagination : null,\r\n          };\r\n        },\r\n        providesTags: (res, _err, arg) => {\r\n          if (typeof arg === 'object' && 'id' in arg) {\r\n            return [{ type: 'User' as const, id: arg.id }];\r\n          } else {\r\n            return [\r\n              ...(res?.users.map(({ id }) => ({ type: 'User' as const, id })) ?? []),\r\n              { type: 'User' as const, id: 'LIST' },\r\n            ];\r\n          }\r\n        },\r\n      }),\r\n      deleteManyUsers: builder.mutation<\r\n        Users.DeleteMany.Response['data'],\r\n        Users.DeleteMany.Request['body']\r\n      >({\r\n        query: (body) => ({\r\n          url: '/admin/users/batch-delete',\r\n          method: 'POST',\r\n          data: body,\r\n        }),\r\n        transformResponse: (res: Users.DeleteMany.Response) => res.data,\r\n        invalidatesTags: ['LicenseLimits', { type: 'User', id: 'LIST' }],\r\n      }),\r\n      /**\r\n       * roles\r\n       */\r\n      createRole: builder.mutation<Roles.Create.Response['data'], Roles.Create.Request['body']>({\r\n        query: (body) => ({\r\n          url: '/admin/roles',\r\n          method: 'POST',\r\n          data: body,\r\n        }),\r\n        transformResponse: (res: Roles.Create.Response) => res.data,\r\n        invalidatesTags: [{ type: 'Role', id: 'LIST' }],\r\n      }),\r\n      getRoles: builder.query<Roles.FindRoles.Response['data'], GetRolesParams | void>({\r\n        query: ({ id, ...params } = {}) => ({\r\n          url: `/admin/roles/${id ?? ''}`,\r\n          method: 'GET',\r\n          config: {\r\n            params,\r\n          },\r\n        }),\r\n        transformResponse: (res: Roles.FindRole.Response | Roles.FindRoles.Response) => {\r\n          let roles: Roles.FindRoles.Response['data'] = [];\r\n\r\n          if (res.data) {\r\n            if (Array.isArray(res.data)) {\r\n              roles = res.data;\r\n            } else {\r\n              roles = [res.data];\r\n            }\r\n          }\r\n\r\n          return roles;\r\n        },\r\n        providesTags: (res, _err, arg) => {\r\n          if (typeof arg === 'object' && 'id' in arg) {\r\n            return [{ type: 'Role' as const, id: arg.id }];\r\n          } else {\r\n            return [\r\n              ...(res?.map(({ id }) => ({ type: 'Role' as const, id })) ?? []),\r\n              { type: 'Role' as const, id: 'LIST' },\r\n            ];\r\n          }\r\n        },\r\n      }),\r\n      updateRole: builder.mutation<\r\n        Roles.Update.Response['data'],\r\n        Roles.Update.Request['body'] & Roles.Update.Request['params']\r\n      >({\r\n        query: ({ id, ...body }) => ({\r\n          url: `/admin/roles/${id}`,\r\n          method: 'PUT',\r\n          data: body,\r\n        }),\r\n        transformResponse: (res: Roles.Create.Response) => res.data,\r\n        invalidatesTags: (_res, _err, { id }) => [{ type: 'Role' as const, id }],\r\n      }),\r\n      getRolePermissions: builder.query<\r\n        Roles.GetPermissions.Response['data'],\r\n        GetRolePermissionsParams\r\n      >({\r\n        query: ({ id, ...params }) => ({\r\n          url: `/admin/roles/${id}/permissions`,\r\n          method: 'GET',\r\n          config: {\r\n            params,\r\n          },\r\n        }),\r\n        transformResponse: (res: Roles.GetPermissions.Response) => res.data,\r\n        providesTags: (_res, _err, { id }) => [{ type: 'RolePermissions' as const, id }],\r\n      }),\r\n      updateRolePermissions: builder.mutation<\r\n        Roles.UpdatePermissions.Response['data'],\r\n        Roles.UpdatePermissions.Request['body'] & Roles.UpdatePermissions.Request['params']\r\n      >({\r\n        query: ({ id, ...body }) => ({\r\n          url: `/admin/roles/${id}/permissions`,\r\n          method: 'PUT',\r\n          data: body,\r\n        }),\r\n        transformResponse: (res: Roles.UpdatePermissions.Response) => res.data,\r\n        invalidatesTags: (_res, _err, { id }) => [{ type: 'RolePermissions' as const, id }],\r\n      }),\r\n      /**\r\n       * Permissions\r\n       */\r\n      getRolePermissionLayout: builder.query<\r\n        Permissions.GetAll.Response['data'],\r\n        Permissions.GetAll.Request['params']\r\n      >({\r\n        query: (params) => ({\r\n          url: '/admin/permissions',\r\n          method: 'GET',\r\n          config: {\r\n            params,\r\n          },\r\n        }),\r\n        transformResponse: (res: Permissions.GetAll.Response) => res.data,\r\n      }),\r\n    }),\r\n    overrideExisting: false,\r\n  });\r\n\r\ntype GetUsersParams =\r\n  | Users.FindOne.Params\r\n  | (Users.FindAll.Request['query'] & { id?: never })\r\n  | void;\r\ntype GetRolesParams =\r\n  | Roles.FindRole.Request['params']\r\n  | (Roles.FindRoles.Request['query'] & { id?: never });\r\ninterface GetRolePermissionsParams {\r\n  id: Data.ID;\r\n}\r\n\r\nconst {\r\n  useCreateUserMutation,\r\n  useGetUsersQuery,\r\n  useUpdateUserMutation,\r\n  useDeleteManyUsersMutation,\r\n  useGetRolesQuery,\r\n  useCreateRoleMutation,\r\n  useUpdateRoleMutation,\r\n  useGetRolePermissionsQuery,\r\n  useGetRolePermissionLayoutQuery,\r\n  useUpdateRolePermissionsMutation,\r\n} = usersService;\r\n\r\nconst useAdminUsers = useGetUsersQuery;\r\n\r\nexport {\r\n  useUpdateUserMutation,\r\n  useGetRolesQuery,\r\n  useAdminUsers,\r\n  useDeleteManyUsersMutation,\r\n  useCreateUserMutation,\r\n  useGetRolePermissionsQuery,\r\n  useGetRolePermissionLayoutQuery,\r\n  useCreateRoleMutation,\r\n  useUpdateRolePermissionsMutation,\r\n  useUpdateRoleMutation,\r\n};\r\nexport type { GetRolesParams, GetUsersParams, GetRolePermissionsParams };\r\n"],
  "mappings": ";;;;;AAQA,IAAM,eAAe,SAClB,iBAAiB;AAAA,EAChB,aAAa,CAAC,iBAAiB,QAAQ,QAAQ,iBAAiB;AAClE,CAAC,EACA,gBAAgB;AAAA,EACf,WAAW,CAAC,aAAa;AAAA;AAAA;AAAA;AAAA,IAIvB,YAAY,QAAQ,SAAsE;AAAA,MACxF,OAAO,CAAC,UAAU;AAAA,QAChB,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,MACA,mBAAmB,CAAC,aAAoC,SAAS;AAAA,MACjE,iBAAiB,CAAC,iBAAiB,EAAE,MAAM,QAAQ,IAAI,OAAO,CAAC;AAAA,IACjE,CAAC;AAAA,IACD,YAAY,QAAQ,SAGlB;AAAA,MACA,OAAO,CAAC,EAAE,IAAI,GAAG,KAAK,OAAO;AAAA,QAC3B,KAAK,gBAAgB,EAAE;AAAA,QACvB,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,MACA,iBAAiB,CAAC,MAAM,MAAM,EAAE,GAAG,MAAM;AAAA,QACvC,EAAE,MAAM,QAAQ,GAAG;AAAA,QACnB,EAAE,MAAM,QAAQ,IAAI,OAAO;AAAA,MAC7B;AAAA,IACF,CAAC;AAAA,IACD,UAAU,QAAQ,MAMhB;AAAA,MACA,OAAO,CAAC,EAAE,IAAI,GAAG,OAAO,IAAI,CAAC,OAAO;AAAA,QAClC,KAAK,gBAAgB,MAAM,EAAE;AAAA,QAC7B,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN;AAAA,QACF;AAAA,MACF;AAAA,MACA,mBAAmB,CAAC,QAAyD;AAC3E,YAAI,QAAmD,CAAC;AAExD,YAAI,IAAI,MAAM;AACZ,cAAI,aAAa,IAAI,MAAM;AACzB,gBAAI,MAAM,QAAQ,IAAI,KAAK,OAAO,GAAG;AACnC,sBAAQ,IAAI,KAAK;AAAA,YACnB;AAAA,UACF,OAAO;AACL,oBAAQ,CAAC,IAAI,IAAI;AAAA,UACnB;AAAA,QACF;AAEA,eAAO;AAAA,UACL;AAAA,UACA,YAAY,gBAAgB,IAAI,OAAO,IAAI,KAAK,aAAa;AAAA,QAC/D;AAAA,MACF;AAAA,MACA,cAAc,CAAC,KAAK,MAAM,QAAQ;AAChC,YAAI,OAAO,QAAQ,YAAY,QAAQ,KAAK;AAC1C,iBAAO,CAAC,EAAE,MAAM,QAAiB,IAAI,IAAI,GAAG,CAAC;AAAA,QAC/C,OAAO;AACL,iBAAO;AAAA,YACL,IAAI,2BAAK,MAAM,IAAI,CAAC,EAAE,GAAG,OAAO,EAAE,MAAM,QAAiB,GAAG,QAAO,CAAC;AAAA,YACpE,EAAE,MAAM,QAAiB,IAAI,OAAO;AAAA,UACtC;AAAA,QACF;AAAA,MACF;AAAA,IACF,CAAC;AAAA,IACD,iBAAiB,QAAQ,SAGvB;AAAA,MACA,OAAO,CAAC,UAAU;AAAA,QAChB,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,MACA,mBAAmB,CAAC,QAAmC,IAAI;AAAA,MAC3D,iBAAiB,CAAC,iBAAiB,EAAE,MAAM,QAAQ,IAAI,OAAO,CAAC;AAAA,IACjE,CAAC;AAAA;AAAA;AAAA;AAAA,IAID,YAAY,QAAQ,SAAsE;AAAA,MACxF,OAAO,CAAC,UAAU;AAAA,QAChB,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,MACA,mBAAmB,CAAC,QAA+B,IAAI;AAAA,MACvD,iBAAiB,CAAC,EAAE,MAAM,QAAQ,IAAI,OAAO,CAAC;AAAA,IAChD,CAAC;AAAA,IACD,UAAU,QAAQ,MAA+D;AAAA,MAC/E,OAAO,CAAC,EAAE,IAAI,GAAG,OAAO,IAAI,CAAC,OAAO;AAAA,QAClC,KAAK,gBAAgB,MAAM,EAAE;AAAA,QAC7B,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN;AAAA,QACF;AAAA,MACF;AAAA,MACA,mBAAmB,CAAC,QAA4D;AAC9E,YAAI,QAA0C,CAAC;AAE/C,YAAI,IAAI,MAAM;AACZ,cAAI,MAAM,QAAQ,IAAI,IAAI,GAAG;AAC3B,oBAAQ,IAAI;AAAA,UACd,OAAO;AACL,oBAAQ,CAAC,IAAI,IAAI;AAAA,UACnB;AAAA,QACF;AAEA,eAAO;AAAA,MACT;AAAA,MACA,cAAc,CAAC,KAAK,MAAM,QAAQ;AAChC,YAAI,OAAO,QAAQ,YAAY,QAAQ,KAAK;AAC1C,iBAAO,CAAC,EAAE,MAAM,QAAiB,IAAI,IAAI,GAAG,CAAC;AAAA,QAC/C,OAAO;AACL,iBAAO;AAAA,YACL,IAAI,2BAAK,IAAI,CAAC,EAAE,GAAG,OAAO,EAAE,MAAM,QAAiB,GAAG,QAAO,CAAC;AAAA,YAC9D,EAAE,MAAM,QAAiB,IAAI,OAAO;AAAA,UACtC;AAAA,QACF;AAAA,MACF;AAAA,IACF,CAAC;AAAA,IACD,YAAY,QAAQ,SAGlB;AAAA,MACA,OAAO,CAAC,EAAE,IAAI,GAAG,KAAK,OAAO;AAAA,QAC3B,KAAK,gBAAgB,EAAE;AAAA,QACvB,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,MACA,mBAAmB,CAAC,QAA+B,IAAI;AAAA,MACvD,iBAAiB,CAAC,MAAM,MAAM,EAAE,GAAG,MAAM,CAAC,EAAE,MAAM,QAAiB,GAAG,CAAC;AAAA,IACzE,CAAC;AAAA,IACD,oBAAoB,QAAQ,MAG1B;AAAA,MACA,OAAO,CAAC,EAAE,IAAI,GAAG,OAAO,OAAO;AAAA,QAC7B,KAAK,gBAAgB,EAAE;AAAA,QACvB,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN;AAAA,QACF;AAAA,MACF;AAAA,MACA,mBAAmB,CAAC,QAAuC,IAAI;AAAA,MAC/D,cAAc,CAAC,MAAM,MAAM,EAAE,GAAG,MAAM,CAAC,EAAE,MAAM,mBAA4B,GAAG,CAAC;AAAA,IACjF,CAAC;AAAA,IACD,uBAAuB,QAAQ,SAG7B;AAAA,MACA,OAAO,CAAC,EAAE,IAAI,GAAG,KAAK,OAAO;AAAA,QAC3B,KAAK,gBAAgB,EAAE;AAAA,QACvB,QAAQ;AAAA,QACR,MAAM;AAAA,MACR;AAAA,MACA,mBAAmB,CAAC,QAA0C,IAAI;AAAA,MAClE,iBAAiB,CAAC,MAAM,MAAM,EAAE,GAAG,MAAM,CAAC,EAAE,MAAM,mBAA4B,GAAG,CAAC;AAAA,IACpF,CAAC;AAAA;AAAA;AAAA;AAAA,IAID,yBAAyB,QAAQ,MAG/B;AAAA,MACA,OAAO,CAAC,YAAY;AAAA,QAClB,KAAK;AAAA,QACL,QAAQ;AAAA,QACR,QAAQ;AAAA,UACN;AAAA,QACF;AAAA,MACF;AAAA,MACA,mBAAmB,CAAC,QAAqC,IAAI;AAAA,IAC/D,CAAC;AAAA,EACH;AAAA,EACA,kBAAkB;AACpB,CAAC;AAaH,IAAM;AAAA,EACJ;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF,IAAI;AAEJ,IAAM,gBAAgB;",
  "names": []
}
