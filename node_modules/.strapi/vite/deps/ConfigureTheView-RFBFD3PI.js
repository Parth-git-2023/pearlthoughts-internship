import {
  useConfig
} from "./chunk-GVMFFF2N.js";
import {
  getTrad,
  pageSizes,
  pluginId,
  sortOptions
} from "./chunk-7PPO62D5.js";
import "./chunk-VGLD7XCK.js";
import "./chunk-2ZQUEACL.js";
import "./chunk-FYXG3DTK.js";
import "./chunk-AUQFPK2Y.js";
import "./chunk-XEUV47ZT.js";
import "./chunk-4J4JH4DL.js";
import "./chunk-HXZ2GHFZ.js";
import "./chunk-G3UG26ZE.js";
import "./chunk-6Q5DMVVB.js";
import "./chunk-D5N4CUND.js";
import "./chunk-Y6F2Z2AQ.js";
import "./chunk-HSX2BZF6.js";
import "./chunk-L5ESVDCC.js";
import "./chunk-XXRLJZ2Z.js";
import "./chunk-7WFYXSNR.js";
import "./chunk-5TWNRMNB.js";
import "./chunk-ZRXSF5PI.js";
import "./chunk-2M3OHFCF.js";
import "./chunk-3QOMPMDL.js";
import "./chunk-L6MVB4FQ.js";
import "./chunk-OQ5X2AZ3.js";
import {
  ConfirmDialog
} from "./chunk-7XSIHJSQ.js";
import "./chunk-PJGZMO5F.js";
import "./chunk-JUJLGPZB.js";
import "./chunk-6GQ5QKHI.js";
import "./chunk-6MHIA2XQ.js";
import "./chunk-JTVP57KZ.js";
import "./chunk-BR5DWYPY.js";
import "./chunk-X5YFDRMS.js";
import "./chunk-LVVND4TK.js";
import {
  Layouts
} from "./chunk-O6JJIRK6.js";
import {
  useTracking
} from "./chunk-DHQERSO6.js";
import "./chunk-GLPT7RON.js";
import "./chunk-54PZNGL6.js";
import {
  Page
} from "./chunk-OUTHPJ5W.js";
import "./chunk-YQN4TQZU.js";
import "./chunk-ITUTZMO4.js";
import {
  useNotification
} from "./chunk-S4GSJQUH.js";
import "./chunk-3CYOA7RQ.js";
import "./chunk-3Y3HZKRY.js";
import "./chunk-PR5W4YOM.js";
import "./chunk-75I5DWRQ.js";
import {
  NavLink
} from "./chunk-QOSJGLB6.js";
import "./chunk-O4TQZ7PI.js";
import "./chunk-6VYH4IES.js";
import "./chunk-ICS3EKH5.js";
import "./chunk-6VU4ULW6.js";
import "./chunk-WA6BWN3W.js";
import "./chunk-UCDGERJK.js";
import "./chunk-I7675365.js";
import "./chunk-EHBUXG3W.js";
import "./chunk-5KTEVKJL.js";
import "./chunk-CEKG4MVB.js";
import "./chunk-CLDKBGB3.js";
import "./chunk-RYHDJ43U.js";
import "./chunk-GARU6WOT.js";
import "./chunk-2T3F2FEA.js";
import "./chunk-FBKW3ZX5.js";
import "./chunk-6XMPWYL4.js";
import {
  require_set
} from "./chunk-4PYOUU3W.js";
import "./chunk-JNCTODJD.js";
import "./chunk-2VOUQL7N.js";
import "./chunk-SMSMUSQ2.js";
import "./chunk-PBKEIS74.js";
import "./chunk-XNLL4XTY.js";
import "./chunk-VJHHRLHY.js";
import "./chunk-HWWDZF4D.js";
import "./chunk-Z7WXACEM.js";
import "./chunk-PZKJYQOP.js";
import "./chunk-KTCYCI5X.js";
import "./chunk-4S6CO3NF.js";
import "./chunk-WZMMABOO.js";
import "./chunk-KU6R7J3L.js";
import "./chunk-ALOZZQWE.js";
import "./chunk-3XH2Q2B6.js";
import "./chunk-SM5ZDAVK.js";
import "./chunk-AAOWBC4P.js";
import "./chunk-AVUVASSG.js";
import "./chunk-DEZRKVMG.js";
import "./chunk-LDTLLP4K.js";
import "./chunk-CFOYKXNH.js";
import "./chunk-DWNGFC4T.js";
import "./chunk-SKI2TI5D.js";
import "./chunk-PQYVQDZP.js";
import "./chunk-ZGAXZ2TY.js";
import "./chunk-6EUDYBNR.js";
import "./chunk-3KMG3VFU.js";
import "./chunk-UTVXCYRG.js";
import {
  Box,
  Button,
  Dialog,
  Field,
  Grid,
  Link,
  SingleSelect,
  SingleSelectOption
} from "./chunk-3AUSDG4O.js";
import {
  ForwardRef$4N,
  ForwardRef$5r
} from "./chunk-F5I3ZVMF.js";
import "./chunk-FJZ2NJT6.js";
import "./chunk-VH7UJDNP.js";
import "./chunk-HG4QJCZT.js";
import "./chunk-I7DIJEXN.js";
import {
  useIntl
} from "./chunk-2BDXRWHF.js";
import "./chunk-SBRVGDJ6.js";
import "./chunk-YUZK7WZ2.js";
import {
  fn
} from "./chunk-NSR7OH4Q.js";
import "./chunk-ZCDXR5JO.js";
import "./chunk-47RN6QNY.js";
import {
  require_isEqual
} from "./chunk-IMHIZKPC.js";
import "./chunk-URNLJJFR.js";
import "./chunk-JHXWLAQ5.js";
import "./chunk-PWXBRFBA.js";
import "./chunk-MZAWSZWW.js";
import "./chunk-QIQU42WJ.js";
import "./chunk-XVBZSUZI.js";
import "./chunk-2NWCSGSS.js";
import {
  require_jsx_runtime
} from "./chunk-GAPF2DTI.js";
import {
  require_react
} from "./chunk-2ZN62OJX.js";
import "./chunk-IV5CMKTD.js";
import {
  require_get
} from "./chunk-ENGB2K3X.js";
import "./chunk-ISIKDMAB.js";
import "./chunk-X5DDYWPV.js";
import "./chunk-TUHVKLNT.js";
import "./chunk-3POB64WN.js";
import "./chunk-63YMLYWU.js";
import "./chunk-YIY4KI6G.js";
import "./chunk-7CLWPW6Q.js";
import "./chunk-IVGYXB4P.js";
import "./chunk-H3WCXLKE.js";
import "./chunk-NDGNZ36Q.js";
import "./chunk-MNGCFISN.js";
import {
  __toESM
} from "./chunk-X6GFWOGJ.js";

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/ConfigureTheView.tsx
var React = __toESM(require_react());
var import_isEqual = __toESM(require_isEqual());

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/components/Settings.tsx
var import_jsx_runtime = __toESM(require_jsx_runtime());
var Settings = ({ sort = "", pageSize = 10, onChange: onChange2 }) => {
  const { formatMessage } = useIntl();
  return (0, import_jsx_runtime.jsx)(
    Box,
    {
      background: "neutral0",
      hasRadius: true,
      shadow: "tableShadow",
      paddingTop: 6,
      paddingBottom: 6,
      paddingLeft: 7,
      paddingRight: 7,
      children: (0, import_jsx_runtime.jsxs)(Grid.Root, { gap: 4, children: [
        (0, import_jsx_runtime.jsx)(Grid.Item, { s: 12, col: 6, direction: "column", alignItems: "stretch", children: (0, import_jsx_runtime.jsxs)(
          Field.Root,
          {
            hint: formatMessage({
              id: getTrad("config.entries.note"),
              defaultMessage: "Number of assets displayed by default in the Media Library"
            }),
            name: "pageSize",
            children: [
              (0, import_jsx_runtime.jsx)(Field.Label, { children: formatMessage({
                id: getTrad("config.entries.title"),
                defaultMessage: "Entries per page"
              }) }),
              (0, import_jsx_runtime.jsx)(
                SingleSelect,
                {
                  onChange: (value) => onChange2({ target: { name: "pageSize", value } }),
                  value: pageSize,
                  children: pageSizes.map((pageSize2) => (0, import_jsx_runtime.jsx)(SingleSelectOption, { value: pageSize2, children: pageSize2 }, pageSize2))
                }
              ),
              (0, import_jsx_runtime.jsx)(Field.Hint, {})
            ]
          }
        ) }),
        (0, import_jsx_runtime.jsx)(Grid.Item, { s: 12, col: 6, direction: "column", alignItems: "stretch", children: (0, import_jsx_runtime.jsxs)(
          Field.Root,
          {
            hint: formatMessage({
              id: getTrad("config.note"),
              defaultMessage: "Note: You can override this value in the media library."
            }),
            name: "sort",
            children: [
              (0, import_jsx_runtime.jsx)(Field.Label, { children: formatMessage({
                id: getTrad("config.sort.title"),
                defaultMessage: "Default sort order"
              }) }),
              (0, import_jsx_runtime.jsx)(
                SingleSelect,
                {
                  onChange: (value) => onChange2({ target: { name: "sort", value } }),
                  value: sort,
                  "test-sort": sort,
                  "data-testid": "sort-select",
                  children: sortOptions.map((filter) => (0, import_jsx_runtime.jsx)(
                    SingleSelectOption,
                    {
                      "data-testid": `sort-option-${filter.value}`,
                      value: filter.value,
                      children: formatMessage({ id: getTrad(filter.key), defaultMessage: `${filter.value}` })
                    },
                    filter.key
                  ))
                }
              ),
              (0, import_jsx_runtime.jsx)(Field.Hint, {})
            ]
          }
        ) })
      ] })
    }
  );
};

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/state/actionTypes.ts
var ON_CHANGE = `${pluginId}/ON_CHANGE`;
var SET_LOADED = `${pluginId}/SET_LOADED`;

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/state/actions.ts
var onChange = ({
  name,
  value
}) => ({
  type: ON_CHANGE,
  keys: name,
  value
});
var setLoaded = () => ({
  type: SET_LOADED
});

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/state/init.ts
var initialState = {
  initialData: {},
  modifiedData: {}
};
var init = (configData) => {
  return {
    ...initialState,
    initialData: configData,
    modifiedData: configData
  };
};

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/state/reducer.ts
var import_get = __toESM(require_get());
var import_set = __toESM(require_set());
var reducer = (state = initialState, action = {
  type: ""
}) => (
  // eslint-disable-next-line consistent-return
  fn(state, (draftState) => {
    switch (action.type) {
      case ON_CHANGE: {
        if ("keys" in action && "value" in action && action.keys) {
          (0, import_set.default)(draftState, ["modifiedData", ...action.keys.split(".")], action.value);
        }
        break;
      }
      case SET_LOADED: {
        const reInitialise = init((0, import_get.default)(draftState, ["modifiedData"], {}));
        draftState.initialData = reInitialise.initialData;
        draftState.modifiedData = reInitialise.modifiedData;
        break;
      }
      default:
        return draftState;
    }
  })
);

// ../packages/core/upload/admin/src/pages/App/ConfigureTheView/ConfigureTheView.tsx
var import_jsx_runtime2 = __toESM(require_jsx_runtime());
var ConfigureTheView = ({ config }) => {
  const { trackUsage } = useTracking();
  const { formatMessage } = useIntl();
  const { toggleNotification } = useNotification();
  const { mutateConfig } = useConfig();
  const { isLoading: isSubmittingForm } = mutateConfig;
  const [showWarningSubmit, setWarningSubmit] = React.useState(false);
  const toggleWarningSubmit = () => setWarningSubmit((prevState) => !prevState);
  const [reducerState, dispatch] = React.useReducer(
    reducer,
    initialState,
    () => init(config)
  );
  const typedDispatch = dispatch;
  const { initialData, modifiedData } = reducerState;
  const handleSubmit = (e) => {
    e.preventDefault();
    toggleWarningSubmit();
  };
  const handleConfirm = async () => {
    trackUsage("willEditMediaLibraryConfig");
    await mutateConfig.mutateAsync(modifiedData);
    setWarningSubmit(false);
    typedDispatch(setLoaded());
    toggleNotification({
      type: "success",
      message: formatMessage({
        id: "notification.form.success.fields",
        defaultMessage: "Changes saved"
      })
    });
  };
  const handleChange = ({
    target: { name, value }
  }) => {
    typedDispatch(onChange({ name, value }));
  };
  return (0, import_jsx_runtime2.jsx)(Layouts.Root, { children: (0, import_jsx_runtime2.jsx)(Page.Main, { "aria-busy": isSubmittingForm, children: (0, import_jsx_runtime2.jsxs)("form", { onSubmit: handleSubmit, children: [
    (0, import_jsx_runtime2.jsx)(
      Layouts.Header,
      {
        navigationAction: (0, import_jsx_runtime2.jsx)(
          Link,
          {
            tag: NavLink,
            startIcon: (0, import_jsx_runtime2.jsx)(ForwardRef$5r, {}),
            to: `/plugins/${pluginId}`,
            id: "go-back",
            children: formatMessage({ id: getTrad("config.back"), defaultMessage: "Back" })
          }
        ),
        primaryAction: (0, import_jsx_runtime2.jsx)(
          Button,
          {
            size: "S",
            startIcon: (0, import_jsx_runtime2.jsx)(ForwardRef$4N, {}),
            disabled: (0, import_isEqual.default)(modifiedData, initialData),
            type: "submit",
            children: formatMessage({ id: "global.save", defaultMessage: "Save" })
          }
        ),
        subtitle: formatMessage({
          id: getTrad("config.subtitle"),
          defaultMessage: "Define the view settings of the media library."
        }),
        title: formatMessage({
          id: getTrad("config.title"),
          defaultMessage: "Configure the view - Media Library"
        })
      }
    ),
    (0, import_jsx_runtime2.jsx)(Layouts.Content, { children: (0, import_jsx_runtime2.jsx)(
      Settings,
      {
        "data-testid": "settings",
        pageSize: modifiedData.pageSize || "",
        sort: modifiedData.sort || "",
        onChange: handleChange
      }
    ) }),
    "x",
    (0, import_jsx_runtime2.jsx)(Dialog.Root, { open: showWarningSubmit, onOpenChange: toggleWarningSubmit, children: (0, import_jsx_runtime2.jsx)(ConfirmDialog, { onConfirm: handleConfirm, variant: "default", children: formatMessage({
      id: getTrad("config.popUpWarning.warning.updateAllSettings"),
      defaultMessage: "This will modify all your settings"
    }) }) })
  ] }) }) });
};
export {
  ConfigureTheView
};
//# sourceMappingURL=ConfigureTheView-RFBFD3PI.js.map
